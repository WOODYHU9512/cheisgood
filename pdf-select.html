<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é¸æ“‡è€ƒå¤é¡Œè§€çœ‹</title>
  <script>
    function loadPDFOptions() {
      const permissions = JSON.parse(localStorage.getItem('permissions'));  
      const username = localStorage.getItem('loggedInUser');  
      const container = document.getElementById('answerContainer');
      const welcomeMessage = document.getElementById('welcomeMessage');

      console.log("ğŸ‘¤ ç•¶å‰ç™»å…¥ç”¨æˆ¶:", username);  
      console.log("ğŸ” ç•¶å‰æ¬Šé™:", permissions);  

      if (!permissions || !username) {
        alert("æ‚¨ç„¡æ¬Šè¨ªå•æ­¤é é¢ï¼Œè«‹å…ˆç™»å…¥ï¼");
        window.location.href = 'index.html';  
        return;
      }

      welcomeMessage.innerText = `æ­¡è¿ï¼Œ${username}ï¼è«‹é¸æ“‡è€ƒå¤é¡Œè§€çœ‹ï¼š`;

      const subjects = [
        { name: "å°å¤§", file: "å°å¤§å…¨éƒ¨.pdf" },
        { name: "æ¸…å¤§", file: "æ¸…å¤§å…¨éƒ¨.pdf" },
        { name: "æˆå¤§", file: "æˆå¤§å…¨éƒ¨.pdf" },
        { name: "å°ç§‘", file: "å°ç§‘å¤§å…¨éƒ¨.pdf" },
        { name: "ä¸­å¤®", file: "ä¸­å¤®å…¨éƒ¨.pdf" },
        { name: "ä¸­èˆˆ", file: "ä¸­èˆˆå…¨éƒ¨.pdf" }
      ];

      subjects.forEach(subject => {
        if (permissions[subject.name]) {  
          let button = document.createElement('button');
          button.innerText = "è§€çœ‹ " + subject.name + " è§£ç­”";
          button.onclick = function() { checkAccessAndShowPDF(subject.file, subject.name); };
          container.appendChild(button);
        }
      });
    }

    function checkAccessAndShowPDF(pdfFile, subjectName) {
      const permissions = JSON.parse(localStorage.getItem('permissions'));

      console.log("ğŸ¯ å˜—è©¦æ‰“é–‹:", pdfFile, " - æ¬Šé™:", permissions);

      if (!permissions || !permissions[subjectName]) {
        alert("ğŸš« æ‚¨ç„¡æ¬Šè¨ªå•æ­¤è§£ç­”ï¼");
        window.location.href = 'index.html';  
      } else {
        localStorage.setItem('currentPDF', pdfFile);  
        window.location.href = `pdf-viewer.html`;  
      }
    }

    window.onload = loadPDFOptions;
  </script>
</head>
<body>
  <h2 id="welcomeMessage"></h2>
  <div id="answerContainer"></div>
</body>
</html>
